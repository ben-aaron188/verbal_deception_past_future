/*
 * ******************************************************************************
 *  $.mb.components
 *  file: $.mb.browser.js
 *
 *  Copyright (c) 2001-2014. Matteo Bicocchi (Pupunzi);
 *  Open lab srl, Firenze - Italy
 *  email: matteo@open-lab.com
 *  site: 	http://pupunzi.com
 *  blog:	http://pupunzi.open-lab.com
 * 	http://open-lab.com
 *
 *  Licences: MIT, GPL
 *  http://www.opensource.org/licenses/mit-license.php
 *  http://www.gnu.org/licenses/gpl.html
 *
 *  last modified: 27/01/14 19.58
 *  *****************************************************************************
 */

/*******************************************************************************
 *
 * $.mb.browser
 * Author: pupunzi
 * Creation date: 16/01/13
 *
 ******************************************************************************/
/*Browser detection patch*/

if(!$.browser){

	$.browser = {};
	$.browser.mozilla = false;
	$.browser.webkit = false;
	$.browser.opera = false;
	$.browser.safari = false;
	$.browser.chrome = false;
	$.browser.msie = false;
	$.browser.android = false;
	$.browser.blackberry = false;
	$.browser.ios = false;
	$.browser.operaMobile = false;
	$.browser.windowsMobile = false;
	$.browser.mobile = false;

	var nAgt = navigator.userAgent;
	$.browser.ua = nAgt;

	$.browser.name  = navigator.appName;
	$.browser.fullVersion  = ''+parseFloat(navigator.appVersion);
	$.browser.majorVersion = parseInt(navigator.appVersion,10);
	var nameOffset,verOffset,ix;

// In Opera, the true version is after "Opera" or after "Version"
	if ((verOffset=nAgt.indexOf("Opera"))!=-1) {
		$.browser.opera = true;
		$.browser.name = "Opera";
		$.browser.fullVersion = nAgt.substring(verOffset+6);
		if ((verOffset=nAgt.indexOf("Version"))!=-1)
			$.browser.fullVersion = nAgt.substring(verOffset+8);
	}

// In MSIE < 11, the true version is after "MSIE" in userAgent
	else if ( (verOffset=nAgt.indexOf("MSIE"))!=-1) {
		$.browser.msie = true;
		$.browser.name = "Microsoft Internet Explorer";
		$.browser.fullVersion = nAgt.substring(verOffset+5);
	}

// In TRIDENT (IE11) => 11, the true version is after "rv:" in userAgent
	else if (nAgt.indexOf("Trident")!=-1 ) {
		$.browser.msie = true;
		$.browser.name = "Microsoft Internet Explorer";
		var start = nAgt.indexOf("rv:")+3;
		var end = start+4;
		$.browser.fullVersion = nAgt.substring(start,end);
	}

// In Chrome, the true version is after "Chrome"
	else if ((verOffset=nAgt.indexOf("Chrome"))!=-1) {
		$.browser.webkit = true;
		$.browser.chrome = true;
		$.browser.name = "Chrome";
		$.browser.fullVersion = nAgt.substring(verOffset+7);
	}
// In Safari, the true version is after "Safari" or after "Version"
	else if ((verOffset=nAgt.indexOf("Safari"))!=-1) {
		$.browser.webkit = true;
		$.browser.safari = true;
		$.browser.name = "Safari";
		$.browser.fullVersion = nAgt.substring(verOffset+7);
		if ((verOffset=nAgt.indexOf("Version"))!=-1)
			$.browser.fullVersion = nAgt.substring(verOffset+8);
	}
// In Safari, the true version is after "Safari" or after "Version"
	else if ((verOffset=nAgt.indexOf("AppleWebkit"))!=-1) {
		$.browser.webkit = true;
		$.browser.name = "Safari";
		$.browser.fullVersion = nAgt.substring(verOffset+7);
		if ((verOffset=nAgt.indexOf("Version"))!=-1)
			$.browser.fullVersion = nAgt.substring(verOffset+8);
	}
// In Firefox, the true version is after "Firefox"
	else if ((verOffset=nAgt.indexOf("Firefox"))!=-1) {
		$.browser.mozilla = true;
		$.browser.name = "Firefox";
		$.browser.fullVersion = nAgt.substring(verOffset+8);
	}
// In most other browsers, "name/version" is at the end of userAgent
	else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) < (verOffset=nAgt.lastIndexOf('/')) ){
		$.browser.name = nAgt.substring(nameOffset,verOffset);
		$.browser.fullVersion = nAgt.substring(verOffset+1);
		if ($.browser.name.toLowerCase()==$.browser.name.toUpperCase()) {
			$.browser.name = navigator.appName;
		}
	}

	/*Check all mobile environments*/
	$.browser.android = (/Android/i).test(nAgt);
	$.browser.blackberry = (/BlackBerry/i).test(nAgt);
	$.browser.ios = (/iPhone|iPad|iPod/i).test(nAgt);
	$.browser.operaMobile = (/Opera Mini/i).test(nAgt);
	$.browser.windowsMobile = (/IEMobile/i).test(nAgt);
	$.browser.mobile = $.browser.android || $.browser.blackberry || $.browser.ios || $.browser.windowsMobile || $.browser.operaMobile;


// trim the fullVersion string at semicolon/space if present
	if ((ix=$.browser.fullVersion.indexOf(";"))!=-1)
		$.browser.fullVersion=$.browser.fullVersion.substring(0,ix);
	if ((ix=$.browser.fullVersion.indexOf(" "))!=-1)
		$.browser.fullVersion=$.browser.fullVersion.substring(0,ix);

	$.browser.majorVersion = parseInt(''+$.browser.fullVersion,10);
	if (isNaN($.browser.majorVersion)) {
		$.browser.fullVersion  = ''+parseFloat(navigator.appVersion);
		$.browser.majorVersion = parseInt(navigator.appVersion,10);
	}
	$.browser.version = $.browser.majorVersion;
}

var txt = '' + 'navigator.appName = ' + navigator.appName + '<br>' + 'navigator.userAgent = ' + navigator.userAgent + '<br><br><br>' + '$.browser.name  = ' + $.browser.name + '<br>' + '$.browser.fullVersion  = ' + $.browser.fullVersion + '<br>' + '$.browser.version = ' + $.browser.version + '<br>' + '$.browser.majorVersion = ' + $.browser.majorVersion + '<br><br><br>' + '$.browser.msie = ' + $.browser.msie + '<br>' + '$.browser.mozilla = ' + $.browser.mozilla + '<br>' + '$.browser.opera = ' + $.browser.opera + '<br>' + '$.browser.chrome = ' + $.browser.chrome + '<br>'+ '$.browser.webkit = ' + $.browser.webkit + '<br>' + '<br>' + '$.browser.android = ' + $.browser.android + '<br>' + '$.browser.blackberry = ' + $.browser.blackberry + '<br>' + '$.browser.ios = ' + $.browser.ios + '<br>' +  '$.browser.operaMobile = ' + $.browser.operaMobile + '<br>' + '$.browser.windowsMobile = ' + $.browser.windowsMobile + '<br>' + '$.browser.mobile = ' + $.browser.mobile;

// window.browser_info = txt;
